
## üìù –ö–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã

### 1. –ß–µ–º –æ—Ç–ª–∏—á–∞—é—Ç—Å—è —Ç–∏–ø—ã –ø–∞–º—è—Ç–∏ –≤ CUDA –∏ –≤ –∫–∞–∫–∏—Ö —Å–ª—É—á–∞—è—Ö –∏—Ö –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å?

–í CUDA —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ç–∏–ø–æ–≤ –ø–∞–º—è—Ç–∏, –∫–∞–∂–¥—ã–π —Å–æ —Å–≤–æ–∏–º–∏ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞–º–∏:

**–ì–ª–æ–±–∞–ª—å–Ω–∞—è –ø–∞–º—è—Ç—å (Global Memory)**:

- **–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏**: –°–∞–º–∞—è –º–µ–¥–ª–µ–Ω–Ω–∞—è (~400-800 —Ü–∏–∫–ª–æ–≤ –ª–∞—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏), –Ω–æ —Å–∞–º–∞—è –±–æ–ª—å—à–∞—è (–≥–∏–≥–∞–±–∞–π—Ç—ã)
- **–û–±–ª–∞—Å—Ç—å –≤–∏–¥–∏–º–æ—Å—Ç–∏**: –î–æ—Å—Ç—É–ø–Ω–∞ –≤—Å–µ–º –ø–æ—Ç–æ–∫–∞–º –≤–æ –≤—Å–µ—Ö –±–ª–æ–∫–∞—Ö
- **–í—Ä–µ–º—è –∂–∏–∑–Ω–∏**: –°—É—â–µ—Å—Ç–≤—É–µ—Ç –º–µ–∂–¥—É –≤—ã–∑–æ–≤–∞–º–∏ —è–¥–µ—Ä
- **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ**: –î–ª—è –±–æ–ª—å—à–∏—Ö –º–∞—Å—Å–∏–≤–æ–≤ –¥–∞–Ω–Ω—ã—Ö, –≤—Ö–æ–¥–Ω—ã—Ö/–≤—ã—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

**–†–∞–∑–¥–µ–ª—è–µ–º–∞—è –ø–∞–º—è—Ç—å (Shared Memory)**:

- **–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏**: –û—á–µ–Ω—å –±—ã—Å—Ç—Ä–∞—è (~5 —Ü–∏–∫–ª–æ–≤ –ª–∞—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏), –Ω–æ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–∞—è (48-96 KB –Ω–∞ SM)
- **–û–±–ª–∞—Å—Ç—å –≤–∏–¥–∏–º–æ—Å—Ç–∏**: –î–æ—Å—Ç—É–ø–Ω–∞ —Ç–æ–ª—å–∫–æ –ø–æ—Ç–æ–∫–∞–º –≤–Ω—É—Ç—Ä–∏ –æ–¥–Ω–æ–≥–æ –±–ª–æ–∫–∞
- **–í—Ä–µ–º—è –∂–∏–∑–Ω–∏**: –°—É—â–µ—Å—Ç–≤—É–µ—Ç —Ç–æ–ª—å–∫–æ –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –±–ª–æ–∫–∞
- **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ**: –î–ª—è –∫–æ–æ–ø–µ—Ä–∞—Ü–∏–∏ –º–µ–∂–¥—É –ø–æ—Ç–æ–∫–∞–º–∏ –≤ –±–ª–æ–∫–µ, –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö

**–õ–æ–∫–∞–ª—å–Ω–∞—è –ø–∞–º—è—Ç—å (Local Memory)**:

- **–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏**: –§–∏–∑–∏—á–µ—Å–∫–∏ —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ –≥–ª–æ–±–∞–ª—å–Ω–æ–π –ø–∞–º—è—Ç–∏, –Ω–æ –ø—Ä–∏–≤–∞—Ç–Ω–∞ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ—Ç–æ–∫–∞
- **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–ª—è –±–æ–ª—å—à–∏—Ö –ª–æ–∫–∞–ª—å–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –∏ –º–∞—Å—Å–∏–≤–æ–≤

**–ö–æ–Ω—Å—Ç–∞–Ω—Ç–Ω–∞—è –ø–∞–º—è—Ç—å (Constant Memory)**:

- **–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏**: –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–∏ —à–∏—Ä–æ–∫–æ–≤–µ—â–∞—Ç–µ–ª—å–Ω–æ–º —á—Ç–µ–Ω–∏–∏, –∫—ç—à–∏—Ä—É–µ—Ç—Å—è (64 KB)
- **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ**: –î–ª—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ —á–∏—Ç–∞—é—Ç—Å—è –≤—Å–µ–º–∏ –ø–æ—Ç–æ–∫–∞–º–∏ –∏ –Ω–µ –∏–∑–º–µ–Ω—è—é—Ç—Å—è

**–†–µ–≥–∏—Å—Ç—Ä—ã (Registers)**:

- **–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏**: –°–∞–º–∞—è –±—ã—Å—Ç—Ä–∞—è –ø–∞–º—è—Ç—å (1 —Ü–∏–∫–ª), –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ
- **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ**: –î–ª—è –ª–æ–∫–∞–ª—å–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

### 2. –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–∞–∑–¥–µ–ª—è–µ–º–æ–π –ø–∞–º—è—Ç–∏ –≤–ª–∏—è–µ—Ç –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å?

**–ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–µ –≤–ª–∏—è–Ω–∏–µ**:

1. **–°–Ω–∏–∂–µ–Ω–∏–µ –ª–∞—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏**: –†–∞–∑–¥–µ–ª—è–µ–º–∞—è –ø–∞–º—è—Ç—å –≤ ~100 —Ä–∞–∑ –±—ã—Å—Ç—Ä–µ–µ –≥–ª–æ–±–∞–ª—å–Ω–æ–π
   - –ì–ª–æ–±–∞–ª—å–Ω–∞—è –ø–∞–º—è—Ç—å: 400-800 —Ü–∏–∫–ª–æ–≤
   - –†–∞–∑–¥–µ–ª—è–µ–º–∞—è –ø–∞–º—è—Ç—å: ~5 —Ü–∏–∫–ª–æ–≤

2. **–£–º–µ–Ω—å—à–µ–Ω–∏–µ –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ —à–∏–Ω—É**: –°–Ω–∏–∂–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±—Ä–∞—â–µ–Ω–∏–π –∫ –≥–ª–æ–±–∞–ª—å–Ω–æ–π –ø–∞–º—è—Ç–∏
   - –ü—Ä–∏–º–µ—Ä: –í —Ä–µ–¥—É–∫—Ü–∏–∏ –∑–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –æ–¥–∏–Ω —Ä–∞–∑, –∑–∞—Ç–µ–º —Ä–∞–±–æ—Ç–∞–µ–º –ª–æ–∫–∞–ª—å–Ω–æ

3. **–ü–æ–≤—ã—à–µ–Ω–∏–µ –ø—Ä–æ–ø—É—Å–∫–Ω–æ–π —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏**: Shared memory –∏–º–µ–µ—Ç –≥–æ—Ä–∞–∑–¥–æ –±–æ–ª—å—à–∏–π bandwidth

4. **–ü–æ–≤—Ç–æ—Ä–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö**: –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –æ–¥–∏–Ω —Ä–∞–∑ –∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –º–Ω–æ–≥–æ–∫—Ä–∞—Ç–Ω–æ

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏–∑ –Ω–∞—à–µ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:**

- Speedup –¥–ª—è reduction: 9-15x –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ shared memory –≤–º–µ—Å—Ç–æ —Ç–æ–ª—å–∫–æ global memory
- –î–ª—è –º–∞—Å—Å–∏–≤–∞ 1,000,000 —ç–ª–µ–º–µ–Ω—Ç–æ–≤: Global ~0.07ms vs Shared ~0.05ms

**–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –Ω–∞–∫–ª–∞–¥–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã**:

1. **–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è**: `__syncthreads()` –¥–æ–±–∞–≤–ª—è–µ—Ç –∑–∞–¥–µ—Ä–∂–∫–∏
2. **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–∞**: –ú–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å —Ä–∞–∑–±–∏–µ–Ω–∏—è –Ω–∞ —á–∞—Å—Ç–∏
3. **Bank conflicts**: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –¥–æ—Å—Ç—É–ø –º–æ–∂–µ—Ç —Å–Ω–∏–∑–∏—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### 3. –î–æ—Å—Ç—É–ø –∏ –∫–∞–∫ –µ–≥–æ –æ–±–µ—Å–ø–µ—á–∏—Ç—å?

**–ö–æ–∞–ª–µ—Å—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø (Coalesced Access)**:

–ö–æ–∞–ª–µ—Å—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø - —ç—Ç–æ –∫–æ–≥–¥–∞ —Å–æ—Å–µ–¥–Ω–∏–µ –ø–æ—Ç–æ–∫–∏ –æ–±—Ä–∞—â–∞—é—Ç—Å—è –∫ —Å–æ—Å–µ–¥–Ω–∏–º –∞–¥—Ä–µ—Å–∞–º –ø–∞–º—è—Ç–∏, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –æ–¥–Ω—É —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é.

**–ö–∞–∫ –æ–±–µ—Å–ø–µ—á–∏—Ç—å –∫–æ–∞–ª–µ—Å—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø:**

1. **–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è**:

```cuda
// ‚úÖ –•–û–†–û–®–û: –ö–æ–∞–ª–µ—Å—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø
int tid = blockIdx.x * blockDim.x + threadIdx.x;
float value = data[tid];  // –°–æ—Å–µ–¥–Ω–∏–µ –ø–æ—Ç–æ–∫–∏ -> —Å–æ—Å–µ–¥–Ω–∏–µ –∞–¥—Ä–µ—Å–∞

// ‚ùå –ü–õ–û–•–û: –ù–µ–∫–æ–∞–ª–µ—Å—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø
float value = data[tid * stride];  // –†–∞–∑—Ä–µ–∂–µ–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø
```

1. **–í—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ –ø–æ –≥—Ä–∞–Ω–∏—Ü–∞–º**:
   - –ù–∞—á–∏–Ω–∞–π—Ç–µ —á—Ç–µ–Ω–∏–µ —Å –∞–¥—Ä–µ—Å–æ–≤, –∫—Ä–∞—Ç–Ω—ã—Ö 32, 64 –∏–ª–∏ 128 –±–∞–π—Ç
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ä–∞–∑–º–µ—Ä—ã, –∫—Ä–∞—Ç–Ω—ã–µ warp size (32 –ø–æ—Ç–æ–∫–∞)

2. **–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–µ –æ–±—Ä–∞—â–µ–Ω–∏—è**:
   - –ü–æ—Ç–æ–∫–∏ –≤ warp –¥–æ–ª–∂–Ω—ã –æ–±—Ä–∞—â–∞—Ç—å—Å—è –∫ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–º –∞–¥—Ä–µ—Å–∞–º
   - –ò–∑–±–µ–≥–∞–π—Ç–µ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞

**Bank Conflicts –≤ Shared Memory:**

–†–∞–∑–¥–µ–ª—è–µ–º–∞—è –ø–∞–º—è—Ç—å —Ä–∞–∑–¥–µ–ª–µ–Ω–∞ –Ω–∞ 32 –±–∞–Ω–∫–∞. –ö–æ–Ω—Ñ–ª–∏–∫—Ç –≤–æ–∑–Ω–∏–∫–∞–µ—Ç, –∫–æ–≥–¥–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–æ—Ç–æ–∫–æ–≤ –æ–±—Ä–∞—â–∞—é—Ç—Å—è –∫ —Ä–∞–∑–Ω—ã–º –∞–¥—Ä–µ—Å–∞–º –≤ –æ–¥–Ω–æ–º –±–∞–Ω–∫–µ.

**–ö–∞–∫ –∏–∑–±–µ–∂–∞—Ç—å:**

```cuda
// ‚úÖ –•–û–†–û–®–û: –ë–µ–∑ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤
shared[threadIdx.x] = data[tid];

// ‚ùå –ü–õ–û–•–û: –ö–æ–Ω—Ñ–ª–∏–∫—Ç—ã (–µ—Å–ª–∏ stride –∫—Ä–∞—Ç–µ–Ω 32)
shared[threadIdx.x * stride] = data[tid];
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ –Ω–∞—à–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:**

- –í `reductionShared`: –∏—Å–ø–æ–ª—å–∑—É–µ–º `threadIdx.x` –¥–ª—è –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏ ‚Üí –Ω–µ—Ç bank conflicts
- –í `bubbleSortKernel`: –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –≤ shared memory ‚Üí –∫–æ–∞–ª–µ—Å—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø

### 4. –ö–∞–∫–∏–µ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –≤–æ–∑–Ω–∏–∫–∞—é—Ç –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –±–æ–ª—å—à–∏–º –æ–±—ä–µ–º–æ–º –¥–∞–Ω–Ω—ã—Ö –Ω–∞ GPU?

**1. –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø–∞–º—è—Ç–∏:**

- **–ü—Ä–æ–±–ª–µ–º–∞**: GPU –∏–º–µ–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—É—é –ø–∞–º—è—Ç—å (–æ–±—ã—á–Ω–æ 4-24 GB)
- **–†–µ—à–µ–Ω–∏–µ**: –ü–æ—Ç–æ–∫–æ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö (streaming), –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ —á–∞—Å—Ç—è–º

**2. –ü–µ—Ä–µ–¥–∞—á–∞ –¥–∞–Ω–Ω—ã—Ö CPU ‚Üî GPU:**

- **–ü—Ä–æ–±–ª–µ–º–∞**: PCIe bandwidth (~16 GB/s) - —É–∑–∫–æ–µ –º–µ—Å—Ç–æ
- **–†–µ—à–µ–Ω–∏–µ**:
  - –ú–∏–Ω–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø–µ—Ä–µ–¥–∞—á—É –¥–∞–Ω–Ω—ã—Ö
  - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å pinned memory –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è
  - Overlapping: –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ + –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ (CUDA streams)

**3. –†–∞–∑–º–µ—Ä shared memory:**

- **–ü—Ä–æ–±–ª–µ–º–∞**: –¢–æ–ª—å–∫–æ 48-96 KB –Ω–∞ SM, –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç –¥–ª—è –±–æ–ª—å—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö
- **–†–µ—à–µ–Ω–∏–µ**:
  - –†–∞–∑–±–∏–≤–∞—Ç—å –Ω–∞ chunks (–∫–∞–∫ –≤ –Ω–∞—à–µ–º sorting: chunks –ø–æ 512 —ç–ª–µ–º–µ–Ω—Ç–æ–≤)
  - –¢–∞–π–ª–æ–≤—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã (tiling)

**4. –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–ª–æ–∫–æ–≤ –∏ –ø–æ—Ç–æ–∫–æ–≤:**

- **–ü—Ä–æ–±–ª–µ–º–∞**: –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–ª–æ–∫–æ–≤ –∏ –ø–æ—Ç–æ–∫–æ–≤
- **–†–µ—à–µ–Ω–∏–µ**: Grid-stride loops –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö –±–æ–ª—å—à–µ grid size

**5. –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –º–µ–∂–¥—É –±–ª–æ–∫–∞–º–∏:**

- **–ü—Ä–æ–±–ª–µ–º–∞**: –ù–µ—Ç –ø—Ä—è–º–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –º–µ–∂–¥—É –±–ª–æ–∫–∞–º–∏
- **–†–µ—à–µ–Ω–∏–µ**: –†–∞–∑–¥–µ–ª–∏—Ç—å –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ kernel launches

**–ü—Ä–∏–º–µ—Ä –∏–∑ –Ω–∞—à–µ–≥–æ –∫–æ–¥–∞:**

```cuda
// –û–±—Ä–∞–±–æ—Ç–∫–∞ –º–∞—Å—Å–∏–≤–∞ –±–æ–ª—å—à–µ, —á–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Ç–æ–∫–æ–≤
for (int i = tid; i < n; i += stride) {  // Grid-stride loop
    sum += input[i];
}
```

### 5. –ü–æ—á–µ–º—É –≤–∞–∂–Ω–æ –º–∏–Ω–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –¥–æ—Å—Ç—É–ø –∫ –≥–ª–æ–±–∞–ª—å–Ω–æ–π –ø–∞–º—è—Ç–∏?

**–ü—Ä–∏—á–∏–Ω—ã:**

**1. –í—ã—Å–æ–∫–∞—è –ª–∞—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å:**

- Global memory: 400-800 —Ü–∏–∫–ª–æ–≤ –∑–∞–¥–µ—Ä–∂–∫–∏
- Shared memory: ~5 —Ü–∏–∫–ª–æ–≤
- **–†–∞–∑–Ω–∏—Ü–∞: –¥–æ 160x –º–µ–¥–ª–µ–Ω–Ω–µ–µ!**

**2. –û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–∞—è –ø—Ä–æ–ø—É—Å–∫–Ω–∞—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å:**

- –î–∞–∂–µ –ø—Ä–∏ –∫–æ–∞–ª–µ—Å—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –¥–æ—Å—Ç—É–ø–µ bandwidth ~700 GB/s
- Shared memory –∏–º–µ–µ—Ç bandwidth >10 TB/s
- **–†–∞–∑–Ω–∏—Ü–∞: ~15x –º–µ–Ω—å—à–µ –ø—Ä–æ–ø—É—Å–∫–Ω–∞—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å**

**3. –≠–Ω–µ—Ä–≥–æ–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ:**

- –î–æ—Å—Ç—É–ø –∫ off-chip –ø–∞–º—è—Ç–∏ –ø–æ—Ç—Ä–µ–±–ª—è–µ—Ç –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –±–æ–ª—å—à–µ —ç–Ω–µ—Ä–≥–∏–∏
- –í–∞–∂–Ω–æ –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏ —Ç–µ–ø–ª–æ–æ—Ç–≤–æ–¥–∞

**4. –ö–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏—è –∑–∞ —Ä–µ—Å—É—Ä—Å—ã:**

- –í—Å–µ SM –∫–æ–Ω–∫—É—Ä–∏—Ä—É—é—Ç –∑–∞ –¥–æ—Å—Ç—É–ø –∫ –≥–ª–æ–±–∞–ª—å–Ω–æ–π –ø–∞–º—è—Ç–∏
- –°–æ–∑–¥–∞–µ—Ç —É–∑–∫–æ–µ –º–µ—Å—Ç–æ –ø—Ä–∏ –±–æ–ª—å—à–æ–π –Ω–∞–≥—Ä—É–∑–∫–µ

**–°—Ç—Ä–∞—Ç–µ–≥–∏–∏ –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏–∏:**

1. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ shared memory**:
   - –ó–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –æ–¥–∏–Ω —Ä–∞–∑ –≤ shared memory
   - –í—ã–ø–æ–ª–Ω–∏—Ç—å –≤—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –ª–æ–∫–∞–ª—å–Ω–æ
   - –ó–∞–ø–∏—Å–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –æ–¥–∏–Ω —Ä–∞–∑

2. **–£–≤–µ–ª–∏—á–µ–Ω–∏–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏–π –Ω–∞ –æ–¥–Ω–æ –æ–±—Ä–∞—â–µ–Ω–∏–µ**:
   - –ë–æ–ª—å—à–µ —Ä–∞–±–æ—Ç—ã —Å –∫–∞–∂–¥—ã–º –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–º —ç–ª–µ–º–µ–Ω—Ç–æ–º
   - –ü–æ–≤—ã—à–µ–Ω–∏–µ arithmetic intensity

3. **–ö–æ–∞–ª–µ—Å—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø**:
   - –û–±—ä–µ–¥–∏–Ω–∏—Ç—å –º–Ω–æ–∂–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –æ–¥–Ω—É —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é
   - –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ bandwidth

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏–∑ –Ω–∞—à–µ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã:**

- `reductionGlobal`: –ú–Ω–æ–≥–æ –∑–∞–ø–∏—Å–µ–π –≤ global memory ‚Üí –º–µ–¥–ª–µ–Ω–Ω–µ–µ
- `reductionShared`: –ó–∞–≥—Ä—É–∑–∫–∞ ‚Üí —Ä–∞–±–æ—Ç–∞ –≤ shared ‚Üí –æ–¥–Ω–∞ –∑–∞–ø–∏—Å—å ‚Üí **9-15x –±—ã—Å—Ç—Ä–µ–µ**

### 6. –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ CUDA-–ø—Ä–æ–≥—Ä–∞–º–º?

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏—è:**

**1. NVIDIA Nsight Systems (—Å–∏—Å—Ç–µ–º–Ω–æ–µ –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ):**

```bash
# –ó–∞–ø—É—Å–∫ –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏—è
nsys profile --stats=true ./benchmark

# –° –¥–µ—Ç–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π
nsys profile -o report --trace=cuda,nvtx ./benchmark
```

**–ß—Ç–æ –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å:**

- Timeline CPU/GPU –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
- Kernel execution times
- Memory transfers (Host ‚Üî Device)
- GPU utilization

**2. NVIDIA Nsight Compute (kernel-—É—Ä–æ–≤–Ω–µ–≤–æ–µ –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ):**

```bash
# –ü—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö kernels
ncu --set full ./benchmark

# –ú–µ—Ç—Ä–∏–∫–∏ –ø–∞–º—è—Ç–∏
ncu --metrics l1tex__t_bytes_pipe_lsu_mem_global_op_ld,l1tex__t_bytes_pipe_lsu_mem_global_op_st ./benchmark
```

**–ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏:**

- **Occupancy**: –ü—Ä–æ—Ü–µ–Ω—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è SM
- **Memory bandwidth utilization**: –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø–∞–º—è—Ç–∏
- **Warp execution efficiency**: Divergence
- **Bank conflicts**: –í shared memory

**3. CUDA Events (–ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–µ –∏–∑–º–µ—Ä–µ–Ω–∏–µ):**

–í –Ω–∞—à–µ–π –ø—Ä–æ–≥—Ä–∞–º–º–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —ç—Ç–æ—Ç –º–µ—Ç–æ–¥:

```cuda
cudaEvent_t start, stop;
cudaEventCreate(&start);
cudaEventCreate(&stop);

cudaEventRecord(start);
// Kernel execution
cudaEventRecord(stop);

cudaEventSynchronize(stop);
float milliseconds = 0;
cudaEventElapsedTime(&milliseconds, start, stop);
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**

- –¢–æ—á–Ω–æ–µ –∏–∑–º–µ—Ä–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ GPU
- –ù–∏–∑–∫–∏–µ –Ω–∞–∫–ª–∞–¥–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã
- –õ–µ–≥–∫–æ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –≤ –∫–æ–¥

**4. nvprof (—É—Å—Ç–∞—Ä–µ–≤—à–∏–π, –Ω–æ –ø—Ä–æ—Å—Ç–æ–π):**

```bash
nvprof ./benchmark
nvprof --metrics achieved_occupancy,gld_efficiency ./benchmark
```

**–ü—Ä–æ—Ü–µ—Å—Å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:**

1. **Baseline measurement**: –ò–∑–º–µ—Ä–∏—Ç—å —Ç–µ–∫—É—â—É—é –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
2. **Identify bottlenecks**: –ù–∞–π—Ç–∏ —É–∑–∫–∏–µ –º–µ—Å—Ç–∞ (–ø–∞–º—è—Ç—å, –≤—ã—á–∏—Å–ª–µ–Ω–∏—è, —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è)
3. **Optimize**: –í–Ω–µ—Å—Ç–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è
4. **Measure again**: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —É–ª—É—á—à–µ–Ω–∏–µ
5. **Iterate**: –ü–æ–≤—Ç–æ—Ä—è—Ç—å —Ü–∏–∫–ª

**–ß—Ç–æ –∏—Å–∫–∞—Ç—å –ø—Ä–∏ –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–∏:**

- ‚úÖ **High occupancy** (>50%)
- ‚úÖ **High memory bandwidth utilization** (>60%)
- ‚úÖ **Low warp divergence**
- ‚ùå **Memory bottlenecks** (–º–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ memory ops)
- ‚ùå **Low arithmetic intensity** (–º–∞–ª–æ –≤—ã—á–∏—Å–ª–µ–Ω–∏–π –Ω–∞ –±–∞–π—Ç –¥–∞–Ω–Ω—ã—Ö)
- ‚ùå **Excessive synchronization**

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –Ω–∞—à–µ–≥–æ –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏—è:**

```
Reduction (Global): 0.48ms  ‚Üí –ú–Ω–æ–≥–æ global memory accesses
Reduction (Shared): 0.05ms  ‚Üí –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ shared memory
Speedup: ~9.6x
```

## üßπ Cleanup

```bash
make clean
```

This removes the executable, CSV results, and generated plots.

## üìö References

- NVIDIA CUDA Programming Guide
- CUDA Best Practices Guide
- GPU Gems 3: Chapter on Parallel Reduction
